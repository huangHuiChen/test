<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
  <script>
 /* JS Test

For any question of this document, we aren't waiting for a number or answer, but we are waiting for javascript functions.

Make a git public repo or add @loiu92 to your private repos.

 Assuming we have an array of factories
*/

const factories = [
  { name: "BR1", employees: ["John", "Alice", "Bob", "Jessie", "Karen"] },
  { name: "BR2", employees: ["Jessie", "Karen", "John"] },
  { name: "BR3", employees: ["Miles", "Eric", "Henry", "Bob"] },
  { name: "BR4", employees: [] }
]; 
//1.Count Employees Number by Factory
document.write('1.Count Employees Number by Factory<br>');
const factory=factories.map(item=>{
    document.write(item.name,':',item.employees.length ,';');
    return {name:item.name,count:item.employees.length};
});
console.log(factory);
//2.Count Factories Number by Employee
document.write('<br><br>2.Count Factories Number by Employee<br>');
const arry2=new Array;
for(i=0;i<factories.length;i++){
        for (j=0;j<factories[i]['employees'].length;j++){
                arry2.push(factories[i]['employees'][j]);
        }
    }
const aaa=arry2.reduce((arr,ite)=>{
    if(ite in arr){
        arr[ite]++;
    }else{
        arr[ite]=1;
    }
    return arr;
},{})
const Employee=new Array;
for(i=0;i<Object.values(aaa).length;i++){
Employee.push({emploee:Object.keys(aaa)[i],count:Object.values(aaa)[i]})
document.write(Object.keys(aaa)[i],':',Object.values(aaa)[i] ,';')
}
console.log(Employee);
//3. Order employees list by alphabetical order
document.write('<br><br>3. Order employees list by alphabetical order');
const alphabetical=factories.map(item=>{
    document.write('<br>',item.name,':',item.employees.sort() ,';')
    return {name:item.name,count:item.employees.sort()};
});
console.log(alphabetical);
/*
const employee = factories.map(item => Object.values(item)[1]);
document.write(factory);
console.log(factory);
*/
//document.write(factories.length);
/*

1. Count Employees Number by Factory // => [ {name: 'BR1', count: 4}, ... ]
2. Count Factories Number by Employee // => [ {employee: 'John', count: 2}, ... ]
3. Order employees list by alphabetical order // =>   { name: "BR2", employees: ["Jessie", "John", "Karen"] }

 Assuming we have a different array

*/
const employeeType = [
      {id: 1, "name": "FullTime", work_begin: "09:00:00", work_end: "17:00:00"},
      {id: 2, "name": "MidTime", work_begin: "12:00:00", work_end: "21:00:00"},
      {id: 3, "name": "HalfTime", work_begin: "20:00:00", work_end: "00:00:00"},
];

const employees = [
        {id: 1, name: "Alice", type: 2},
        {id: 2, name: "Bob", type: 3},
        {id: 3, name: "John", type: 2},
        {id: 4, name: "Karen", type: 1},
        {id: 5, name: "Miles", type: 3},
        {id: 6, name: "Henry", type: 1}
];

const tasks = [
      {id: 1, title: "task01", duration: 60 },//min
      {id: 2, title: "task02", duration: 120},
      {id: 3, title: "task03", duration: 180},
      {id: 4, title: "task04", duration: 360},
      {id: 5, title: "task05", duration: 30},
      {id: 6, title: "task06", duration: 220},
      {id: 7, title: "task07", duration: 640},
      {id: 8, title: "task08", duration: 250},
      {id: 9, title: "task09", duration: 119},
      {id: 10, title: "task10", duration: 560},
      {id: 11, title: "task11", duration: 340},
      {id: 12, title: "task12", duration: 45},
      {id: 13, title: "task13", duration: 86},
      {id: 14, title: "task14", duration: 480},
      {id: 15, title: "task15", duration: 900}
];

//4.Count total hours worked in 1 day ?
const t_hour=new Array; //區分工時FullTimen→9hr
const e_hour=new Array; //員工時數
for(i=0;i<employeeType.length;i++){
    const a=employeeType[i]['work_begin'].split(":");
    const b=new Date (0,0,0,a[0],a[1],a[2])
    const c=employeeType[i]['work_end'].split(":");
    const d=new Date (0,0,0,c[0],c[1],c[2])
    var hour=Math.floor((d-b) / 1000 / 60 / 60)
    if (hour <0){
        hour=hour+24;
    }
    t_hour.push(hour)
}
for(i=0;i<employees.length;i++){
    if (employees[i]['type']===1){
        e_hour.push(t_hour[0]);
    }else if (employees[i]['type']===2) {
        e_hour.push(t_hour[1]);
    } else {
        e_hour.push(t_hour[2]);
    }
}
var tot_hours=e_hour.reduce((a,b)=>a+b);
document.write('<br><br>4.Count total hours worked in 1 day ?<br>Ans:',tot_hours,'hr');
console.log(tot_hours);

//5. Make a function that take as parameters dayTime and return number of employee working // howManyEmployeeByTime(time) => int
document.write('<br><br>5. Make a function that take as parameters dayTime and return number of employee working  howManyEmployeeByTime(time) => int');
//dayTime以工作時數來區分，ext:FullTimen→9hr
function howManyEmployeeByTime(dayTime){
    var e_count=0;
    for(i=0;i<employees.length;i++){
        if (dayTime===t_hour[0]){
            if (employees[i]['type']===1){
                e_count=e_count+1;
            }
        }else if (dayTime===t_hour[1]) {
            if (employees[i]['type']===2){
                e_count=e_count+1;
            }
        } else if (dayTime===t_hour[2]){
            if (employees[i]['type']===3){
                e_count=e_count+1;
            }
        }
    
    }
    return e_count;
}
const c=howManyEmployeeByTime(4);
document.write("<br>const c=howManyEmployeeByTime(4)=",c,)
console.log(c);
//6.How many days of work needed to done all tasks ?
document.write("<br><br>6.How many days of work needed to done all tasks ?");
const tot_task=new Array;
for (i=0;i<tasks.length;i++){
    tot_task.push(tasks[i]['duration']/60);
}
var tot_task_hour=tot_task.reduce((a,b)=>a+b);
const start_time=new Date (0,0,0,9,0,0)
const end_time=new Date (0,0,0,0,0,0)
var hour_time=Math.floor((end_time-start_time) / 1000 / 60 / 60)
if (hour_time<0){
    hour_time=hour_time+24;
}
var need_date1=(tot_task_hour/hour_time)-parseInt(tot_task_hour/hour_time)!==0 ? parseInt(tot_task_hour/hour_time)+1:(tot_task_hour/hour_time);
console.log(need_date1);
document.write("<br>工作總時數: ",tot_task_hour);
document.write("<br>每天工作時數: ",hour_time);
document.write("<br>需要工作天數: ",need_date1);
/*
4. Count total hours worked in 1 day ? // => 39
5. Make a function that take as parameters dayTime and return number of employee working // howManyEmployeeByTime(time) => int
6. How many days of work needed to done all tasks ? // => 1 day = 9:00 to 00:00 between 00:00 and 09:00 doesnt count.
*/
  </script> 

</body>
</html>
